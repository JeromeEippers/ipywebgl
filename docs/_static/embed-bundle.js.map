{"version":3,"file":"embed-bundle.js","mappings":"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","sources":["webpack://ipywebgl/./css/widget.css","webpack://ipywebgl/./node_modules/css-loader/dist/runtime/api.js","webpack://ipywebgl/./css/widget.css?2598","webpack://ipywebgl/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://ipywebgl/./src/arraybuffer.ts","webpack://ipywebgl/./src/glresource.ts","webpack://ipywebgl/./src/glviewer.ts","webpack://ipywebgl/./src/index.ts","webpack://ipywebgl/./src/matrix.ts","webpack://ipywebgl/./src/version.ts","webpack://ipywebgl/./src/widgets.ts","webpack://ipywebgl/external amd \"@jupyter-widgets/base\"","webpack://ipywebgl/webpack/bootstrap","webpack://ipywebgl/webpack/runtime/nonce","webpack://ipywebgl/webpack/startup"],"sourcesContent":["// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".ipywebgl-json-display {\\r\\n  padding: 10px;\\r\\n  font-family: sans-serif;\\r\\n  background-color: #f2f2f2;\\r\\n  margin-left: 20px;\\r\\n}\\r\\n\\r\\n.ipywebgl-json-key {\\r\\n  font-weight: bold;\\r\\n  color: #333;\\r\\n}\\r\\n\\r\\n.ipywebgl-json-value {\\r\\n  color: #555;\\r\\n}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","var api = require(\"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../node_modules/css-loader/dist/cjs.js!./widget.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","export function buffer_to_array(dtype:String, buffer: any) {\r\n    switch (dtype) {\r\n      case 'int8':\r\n        return new Int8Array(buffer);\r\n        break;\r\n      case 'uint8':\r\n        return new Uint8Array(buffer);\r\n        break;\r\n      case 'int16':\r\n        return new Int16Array(buffer);\r\n        break;\r\n      case 'uint16':\r\n        return new Uint16Array(buffer);\r\n        break;\r\n      case 'int32':\r\n        return new Int32Array(buffer);\r\n        break;\r\n      case 'uint32':\r\n        return new Uint32Array(buffer);\r\n        break;\r\n      case 'float32':\r\n        return new Float32Array(buffer);\r\n        break;\r\n      case 'float64':\r\n        return new Float64Array(buffer);\r\n        break;\r\n      default:\r\n        throw 'Unknown dtype ' + dtype;\r\n        break;\r\n    }\r\n  }","import {\r\n    DOMWidgetModel,\r\n    DOMWidgetView,\r\n    ISerializers,\r\n    unpack_models\r\n  } from '@jupyter-widgets/base';\r\n  \r\nimport { MODULE_NAME, MODULE_VERSION } from './version';\r\n\r\n// Import the CSS\r\nimport '../css/widget.css';\r\n\r\nexport class GLResource extends DOMWidgetModel{\r\n    defaults() {\r\n      return {\r\n        ...super.defaults(),\r\n        _model_name: 'GLResource',\r\n        _model_module: MODULE_NAME,\r\n        _model_module_version: MODULE_VERSION,\r\n        _view_name: 'GLResourceView',\r\n        _view_module: MODULE_NAME,\r\n        _view_module_version: MODULE_VERSION,\r\n  \r\n        _context: null,\r\n        _gl_ptr:null,\r\n        _info: {type:'not set'},\r\n  \r\n        uid: 0,\r\n      };\r\n    }\r\n\r\n    static serializers: ISerializers = {\r\n        ...DOMWidgetModel.serializers,\r\n        _context: { deserialize: unpack_models },\r\n      };\r\n    \r\n    initialize(attributes: any, options: any) {\r\n        super.initialize(attributes, options);\r\n        this.get('_context').register_resource(this);\r\n    }\r\n}\r\n  \r\nexport class GLResourceView extends DOMWidgetView {\r\n\r\n    render() {\r\n\r\n      const root = this.el;\r\n      const jsonDisplay = document.createElement(\"div\");\r\n      jsonDisplay.classList.add(\"ipywebgl-json-display\");\r\n  \r\n      const jsonKey = document.createElement(\"div\");\r\n      jsonKey.classList.add(\"ipywebgl-json-key\");\r\n      jsonKey.textContent = \"uid:\";\r\n\r\n      const jsonValue = document.createElement(\"div\");\r\n      jsonValue.classList.add(\"ipywebgl-json-value\");\r\n      jsonValue.textContent = this.model.get('uid');\r\n      jsonDisplay.appendChild(jsonKey);\r\n      jsonDisplay.appendChild(jsonValue);\r\n\r\n      this.displayJson(this.model.get('_info'), jsonDisplay);\r\n      root.appendChild(jsonDisplay);\r\n    }\r\n\r\n    displayJson(json:any, parent:any) {\r\n      for (const key in json) {\r\n        const jsonKey = document.createElement(\"div\");\r\n        jsonKey.classList.add(\"ipywebgl-json-key\");\r\n        jsonKey.textContent = `${key}:`;\r\n\r\n        const jsonValue = document.createElement(\"div\");\r\n        jsonValue.classList.add(\"ipywebgl-json-value\");\r\n\r\n        if (typeof json[key] === \"object\") {\r\n          const nestedJsonDisplay = document.createElement(\"div\");\r\n          nestedJsonDisplay.classList.add(\"ipywebgl-json-display\");\r\n\r\n          this.displayJson(json[key], nestedJsonDisplay);\r\n          jsonValue.appendChild(nestedJsonDisplay);\r\n        } else {\r\n          jsonValue.textContent = json[key];\r\n        }\r\n\r\n        parent.appendChild(jsonKey);\r\n        parent.appendChild(jsonValue);\r\n      }\r\n    }\r\n\r\n    \r\n}\r\n\r\n  ","import {\r\n  DOMWidgetModel,\r\n  DOMWidgetView,\r\n  ISerializers,\r\n} from '@jupyter-widgets/base';\r\n\r\nimport { MODULE_NAME, MODULE_VERSION } from './version';\r\n\r\nimport { m4dot, m4getColumnI, m4getColumnK, m4inverse, m4ProjectionMatrix, m4Translation, m4Transpose, m4Xrotation, m4Yrotation, vec3Add, vec3Scale } from './matrix';\r\nimport { GLResource } from './glresource';\r\nimport { buffer_to_array } from './arraybuffer';\r\n\r\n\r\nexport class GLModel extends DOMWidgetModel {\r\n  defaults() {\r\n    return {\r\n      ...super.defaults(),\r\n      _model_name: 'GLModel',\r\n      _model_module: MODULE_NAME,\r\n      _model_module_version: MODULE_VERSION,\r\n      _view_name: 'GLViewer',\r\n      _view_module: MODULE_NAME,\r\n      _view_module_version: MODULE_VERSION,\r\n      shader_matrix_major:'row_major',\r\n      width:700,\r\n      height:500,\r\n      camera_pos:[0,50,200],\r\n      camera_yaw:0,\r\n      camera_pitch:0,\r\n      mouse_speed:1,\r\n      move_speed:1,\r\n      move_keys:'wasd',\r\n    };\r\n  }\r\n\r\n  static serializers: ISerializers = {\r\n    ...DOMWidgetModel.serializers,\r\n  };\r\n\r\n  initialize(attributes: any, options: any) {\r\n    super.initialize(attributes, options);\r\n\r\n    this.canvas = document.createElement('canvas');\r\n    this.ctx = this.canvas.getContext(\"webgl2\", {preserveDrawingBuffer: true});\r\n    if (this.ctx == null){\r\n      console.error('could not create a webgl2 context, this is not supported in your browser');\r\n    }\r\n    else{\r\n      const gl:WebGL2RenderingContext = this.ctx;\r\n      this.view_block = gl.createBuffer();\r\n      gl.bindBuffer(gl.UNIFORM_BUFFER, this.view_block);\r\n      gl.bufferData(gl.UNIFORM_BUFFER, 256, gl.DYNAMIC_DRAW);\r\n      gl.bindBuffer(gl.UNIFORM_BUFFER, null);\r\n      gl.bindBufferBase(gl.UNIFORM_BUFFER, 0, this.view_block);\r\n\r\n      //extensions to activate\r\n      gl.getExtension(\"EXT_color_buffer_float\")\r\n    }\r\n\r\n    this.resizeCanvas();\r\n    this.on_some_change(['width', 'height'], this.resizeCanvas, this);\r\n    this.on_some_change(['camera_pos', 'camera_yaw', 'camera_pitch'], this.run_commands, this);\r\n\r\n    this.on('msg:custom', this.handle_custom_messages, this);\r\n\r\n    this.camera_matrix = m4Translation(0,50,200);\r\n    this.view_matrix = m4inverse(this.camera_matrix);\r\n  }\r\n\r\n  resizeCanvas() {\r\n    this.canvas.setAttribute('width', this.get('width'));\r\n    this.canvas.setAttribute('height', this.get('height'));\r\n    if (this.ctx != null){\r\n      this.ctx.viewport(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n    }\r\n    this.projection_matrix = m4ProjectionMatrix(50.0, this.get('width')/this.get('height'), 1.0, 5000.0);\r\n  }\r\n\r\n  handle_custom_messages(command: any, buffers:any) {\r\n    if(command.clear == true){\r\n      this.commands = [];\r\n      this.buffers = [];\r\n    }\r\n    let commands = command.commands;\r\n    let converted_buffers:any[] = [];\r\n    commands.forEach((element:any)=>{\r\n      if (element.hasOwnProperty('buffer_metadata')) {\r\n        const converted = buffer_to_array(element.buffer_metadata.dtype, buffers[element.buffer_metadata.index].buffer);\r\n        converted_buffers.push(converted);\r\n      }\r\n    });\r\n\r\n    if(command.only_once == true){\r\n      this.execute_commands(commands, converted_buffers);\r\n    }\r\n    else{\r\n      let buffer_id_offset = this.buffers.length;\r\n      this.buffers = this.buffers.concat(converted_buffers);\r\n      commands.forEach((element:any)=>{\r\n        if (element.hasOwnProperty('buffer_metadata')) {\r\n          element.buffer_metadata.index += buffer_id_offset;\r\n        }\r\n      });\r\n      this.commands = this.commands.concat(commands);\r\n    }\r\n\r\n    this.run_commands();\r\n  }\r\n\r\n  private update_camera(){\r\n    let pos = this.get('camera_pos');\r\n    let yaw = this.get('camera_yaw') * Math.PI / 180.0;\r\n    let pitch = this.get('camera_pitch') * Math.PI / 180.0;\r\n    this.camera_matrix = m4Translation(pos[0], pos[1], pos[2]);\r\n    this.camera_matrix = m4dot(this.camera_matrix, m4Yrotation(yaw));\r\n    this.camera_matrix = m4dot(this.camera_matrix, m4Xrotation(pitch));\r\n    this.view_matrix = m4inverse(this.camera_matrix);\r\n    this.view_proj_matrix = m4dot(this.projection_matrix, this.view_matrix);\r\n  }\r\n\r\n  run_commands(){\r\n    this.execute_commands(this.commands, this.buffers);\r\n  }\r\n\r\n  execute_commands(commands:any[], converted_buffers:any[]){\r\n    if (this.ctx == null) return;\r\n    const gl:WebGL2RenderingContext = this.ctx;\r\n\r\n    this.update_camera();\r\n\r\n    // update the uniform Block\r\n    let cm = (this.get('shader_matrix_major')=='row_major')? m4Transpose(this.camera_matrix): this.camera_matrix;\r\n    const cm_f32 = new Float32Array(cm);\r\n    let vm = (this.get('shader_matrix_major')=='row_major')? m4Transpose(this.view_matrix): this.view_matrix;\r\n    const vm_f32 = new Float32Array(vm);\r\n    let pm = (this.get('shader_matrix_major')=='row_major')? m4Transpose(this.projection_matrix): this.projection_matrix;\r\n    const pm_f32 = new Float32Array(pm);\r\n    let vpm = (this.get('shader_matrix_major')=='row_major')? m4Transpose(this.view_proj_matrix): this.view_proj_matrix;\r\n    const vpm_f32 = new Float32Array(vpm);\r\n\r\n    gl.bindBuffer(gl.UNIFORM_BUFFER, this.view_block);\r\n    gl.bufferSubData(gl.UNIFORM_BUFFER, 0, cm_f32, 0);\r\n    gl.bufferSubData(gl.UNIFORM_BUFFER, 64, vm_f32, 0);\r\n    gl.bufferSubData(gl.UNIFORM_BUFFER, 128, pm_f32, 0);\r\n    gl.bufferSubData(gl.UNIFORM_BUFFER, 192, vpm_f32, 0);\r\n    gl.bindBuffer(gl.UNIFORM_BUFFER, null);\r\n\r\n    commands.forEach((command:any)=>{\r\n      this.execute_command(gl, command, converted_buffers);\r\n    });\r\n  }\r\n\r\n  glEnumToString(gl:WebGL2RenderingContext, value:any) {\r\n    const keys = [];\r\n    for (const key in gl) {\r\n      if ((gl as any)[key] === value) {\r\n        keys.push(key);\r\n      }\r\n    }\r\n    return keys.length ? keys.join(' | ') : `0x${value.toString(16)}`;\r\n  }\r\n\r\n  execute_command(gl:WebGL2RenderingContext, command:any, converted_buffers:any[]){\r\n    //console.log(command);\r\n    //console.log(this.bound_buffers);\r\n    switch(command.cmd){\r\n      case 'viewport':\r\n          gl.viewport(command.x, command.y, command.width, command.height);\r\n        break;\r\n      case 'enable':\r\n      case 'disable':\r\n        {\r\n          let cap = 0;\r\n          if (command.blend) cap |= gl.BLEND;\r\n          if (command.depth_test) cap |= gl.DEPTH_TEST;\r\n          if (command.dither) cap |= gl.DITHER;\r\n          if (command.polygon_offset_fill) cap |= gl.POLYGON_OFFSET_FILL;\r\n          if (command.sample_alpha_to_coverage) cap |= gl.SAMPLE_ALPHA_TO_COVERAGE;\r\n          if (command.sample_coverage) cap |= gl.SAMPLE_COVERAGE;\r\n          if (command.scissor_test) cap |= gl.SCISSOR_TEST;\r\n          if (command.stencil_test) cap |= gl.STENCIL_TEST;\r\n          if (command.rasterizer_discard) cap |= gl.RASTERIZER_DISCARD;\r\n          if (command.cull_face) cap |= gl.CULL_FACE;\r\n          if (command.cmd == 'enable'){\r\n            gl.enable(cap);\r\n          } else{\r\n            gl.disable(cap);\r\n          }\r\n        }\r\n        break;\r\n      case 'clearColor':\r\n          gl.clearColor(command.r, command.g, command.b, command.a);\r\n        break;\r\n      case 'clear':{\r\n        let bits = 0;\r\n        if (command.depth) bits |= gl.DEPTH_BUFFER_BIT;\r\n        if (command.color) bits |= gl.COLOR_BUFFER_BIT;\r\n        if (command.stencil) bits |= gl.STENCIL_BUFFER_BIT;\r\n        gl.clear(bits);\r\n      }\r\n      break;\r\n      case 'frontFace':{\r\n        gl.frontFace((gl as any)[command.mode]);\r\n      }\r\n      break;\r\n      case 'cullFace':{\r\n        gl.cullFace((gl as any)[command.mode]);\r\n      }\r\n      break;\r\n\r\n      // ------------------------------- DEPTH --------------------------------------\r\n      case 'depthFunc':{\r\n        gl.depthFunc((gl as any)[command.func]);\r\n      }\r\n      break;\r\n      case 'depthMask':{\r\n        gl.depthMask(command.flag);\r\n      }\r\n      break;\r\n      case 'depthRange':{\r\n        gl.depthRange(command.z_near, command.z_far);\r\n      }\r\n      break;\r\n\r\n      // ------------------------------- COLOR --------------------------------------\r\n      case 'blendColor':\r\n          gl.blendColor(command.r, command.g, command.b, command.a);\r\n        break;\r\n      case 'blendEquation':\r\n        gl.blendEquation((gl as any)[command.mode]);\r\n        break;\r\n      case 'blendEquationSeparate':\r\n          gl.blendEquationSeparate((gl as any)[command.mode_rgb], (gl as any)[command.mode_alpha]);\r\n          break;\r\n      case 'blendFunc':\r\n          gl.blendFunc((gl as any)[command.s_factor], (gl as any)[command.d_factor])\r\n      break;\r\n      case 'blend_func_separate':\r\n         gl.blendFuncSeparate((gl as any)[command.src_rgb], (gl as any)[command.dst_rgb], (gl as any)[command.src_alpha], (gl as any)[command.dst_alpha])\r\n        break;\r\n        \r\n      // ------------------------------- TEXTURE --------------------------------------\r\n      case 'createTexture':{\r\n        let res = this.get_resource(command.resource);\r\n        const ptr = gl.createTexture();\r\n        res.set('_gl_ptr', ptr);\r\n        res.set('_info', {type:'texture'});\r\n        res.save_changes();\r\n      }\r\n      break;\r\n      case 'bindTexture':{\r\n        if (command.texture > -1){\r\n          const texture = this.get_resource(command.texture).get('_gl_ptr');\r\n          gl.bindTexture((gl as any)[command.target], texture);\r\n        }\r\n        else{\r\n          gl.bindTexture((gl as any)[command.target], null);\r\n        }\r\n      }\r\n      break;\r\n      case 'activeTexture':\r\n        gl.activeTexture(gl.TEXTURE0 + command.texture);\r\n      break;\r\n      case 'generateMipmap':\r\n        gl.generateMipmap((gl as any)[command.target]);\r\n      break;\r\n      case 'texImage2D':\r\n        if (command.hasOwnProperty('buffer_metadata')){\r\n          gl.texImage2D(\r\n            (gl as any)[command.target],\r\n            command.level,\r\n            (gl as any)[command.internal_format],\r\n            command.width,\r\n            command.height,\r\n            command.border,\r\n            (gl as any)[command.format],\r\n            (gl as any)[command.data_type],\r\n            converted_buffers[command.buffer_metadata.index]\r\n          )\r\n        }\r\n        else{\r\n          gl.texImage2D(\r\n            (gl as any)[command.target],\r\n            command.level,\r\n            (gl as any)[command.internal_format],\r\n            command.width,\r\n            command.height,\r\n            command.border,\r\n            (gl as any)[command.format],\r\n            (gl as any)[command.data_type],\r\n            null\r\n          )\r\n        }\r\n      break;\r\n      case 'texStorage2D':{\r\n        gl.texStorage2D(\r\n          (gl as any)[command.target],\r\n          command.levels,\r\n          (gl as any)[command.internal_format],\r\n          command.width,\r\n          command.height\r\n        );\r\n      }\r\n      break;\r\n      case 'texImage3D':\r\n        if (command.hasOwnProperty('buffer_metadata')){\r\n          gl.texImage3D(\r\n            (gl as any)[command.target],\r\n            command.level,\r\n            (gl as any)[command.internal_format],\r\n            command.width,\r\n            command.height,\r\n            command.depth,\r\n            command.border,\r\n            (gl as any)[command.format],\r\n            (gl as any)[command.data_type],\r\n            converted_buffers[command.buffer_metadata.index]\r\n          )\r\n        }else{\r\n          gl.texImage3D(\r\n            (gl as any)[command.target],\r\n            command.level,\r\n            (gl as any)[command.internal_format],\r\n            command.width,\r\n            command.height,\r\n            command.depth,\r\n            command.border,\r\n            (gl as any)[command.format],\r\n            (gl as any)[command.data_type],\r\n            null\r\n          )\r\n        }\r\n      break;\r\n      case 'texStorage3D':{\r\n        gl.texStorage3D(\r\n          (gl as any)[command.target],\r\n          command.levels,\r\n          (gl as any)[command.internal_format],\r\n          command.width,\r\n          command.height,\r\n          command.depth\r\n        );\r\n      }\r\n      break;\r\n      case 'texParameteri':\r\n        gl.texParameteri((gl as any)[command.target], (gl as any)[command.pname], command.param);\r\n      break;\r\n      case 'texParameterf':\r\n        gl.texParameterf((gl as any)[command.target], (gl as any)[command.pname], command.param);\r\n      break;\r\n      case 'texParameter_str':\r\n        gl.texParameteri((gl as any)[command.target], (gl as any)[command.pname], (gl as any)[command.param]);\r\n      break;\r\n      case 'pixelStorei':{\r\n        if (command.pname == 'UNPACK_COLORSPACE_CONVERSION_WEBGL'){\r\n          gl.pixelStorei((gl as any)[command.pname], (gl as any)[command.param]);\r\n        }\r\n        else{\r\n          gl.pixelStorei((gl as any)[command.pname], command.param);\r\n        }\r\n      }\r\n      break;\r\n      // ------------------------------- SHADERS --------------------------------------\r\n      case 'createShader':{\r\n        let res = this.get_resource(command.resource);\r\n        const ptr = gl.createShader((gl as any)[command.type]);\r\n        res.set('_gl_ptr', ptr);\r\n        res.set('_info', {type:command.type});\r\n        res.save_changes();\r\n      }\r\n      break;\r\n      case 'shaderSource':{\r\n        const res = this.get_resource(command.shader);\r\n          const ptr = res.get('_gl_ptr');\r\n          gl.shaderSource(ptr, command.source);\r\n        }\r\n        break;\r\n      case 'compileShader':{\r\n          const res = this.get_resource(command.shader);\r\n          const ptr = res.get('_gl_ptr');\r\n          gl.compileShader(ptr);\r\n          let resinfo = res.get('_info');\r\n\r\n          if ( !gl.getShaderParameter(ptr, gl.COMPILE_STATUS) ) {\r\n            let info = gl.getShaderInfoLog( ptr );\r\n            resinfo.message = info;\r\n          }\r\n          else{\r\n            resinfo.message = 'compiled';\r\n          }\r\n          res.set('_info', resinfo);\r\n          res.save_changes();\r\n        }\r\n        break;\r\n      // ------------------------------- PROGRAMS --------------------------------------\r\n      case 'createProgram':{\r\n          let res = this.get_resource(command.resource);\r\n          const ptr = gl.createProgram();\r\n          res.set('_gl_ptr', ptr);\r\n          res.set('_info', {type:'Program'});\r\n          res.save_changes();\r\n        }\r\n        break;\r\n      case 'attachShader':{\r\n          const prog = this.get_resource(command.program).get('_gl_ptr');\r\n          const shader = this.get_resource(command.shader).get('_gl_ptr');\r\n          gl.attachShader(prog, shader);\r\n        }\r\n        break;\r\n      case 'bindAttribLocation':{\r\n          let res = this.get_resource(command.program);\r\n          const ptr = res.get('_gl_ptr');\r\n          gl.bindAttribLocation(ptr, command.index, command.name);\r\n        }\r\n        break;\r\n      case 'linkProgram':{\r\n          let res = this.get_resource(command.program);\r\n          const ptr = res.get('_gl_ptr');\r\n          gl.linkProgram(ptr);\r\n          gl.validateProgram(ptr);\r\n          let resinfo = res.get('_info');\r\n\r\n          if ( !gl.getProgramParameter( ptr, gl.LINK_STATUS) ) {\r\n            let info = gl.getShaderInfoLog( ptr );\r\n            resinfo.message = info;\r\n          }\r\n          else{\r\n            //bind our viewBlock\r\n            let viewBlockIndex = gl.getUniformBlockIndex(ptr, 'ViewBlock');\r\n            if (viewBlockIndex < 4294967295){\r\n              gl.uniformBlockBinding(ptr, viewBlockIndex, 0);\r\n            }\r\n            resinfo.message = 'linked';\r\n            resinfo.uniforms_blocks = [];\r\n            resinfo.uniforms = [];\r\n            const numUniforms = gl.getProgramParameter(ptr, gl.ACTIVE_UNIFORMS);\r\n            const indices = [...Array(numUniforms).keys()];\r\n            const blockIndices = gl.getActiveUniforms(ptr, indices, gl.UNIFORM_BLOCK_INDEX);\r\n            const offsets = gl.getActiveUniforms(ptr, indices, gl.UNIFORM_OFFSET);\r\n            for (let i = 0; i < numUniforms; ++i) {\r\n              const info = gl.getActiveUniform(ptr, i);\r\n              if (info){\r\n                // regroup the blocks\r\n                if (blockIndices[i]>-1){\r\n                  let uniform_block = resinfo.uniforms_blocks.find((element:any)=>{return element.index == blockIndices[i]});\r\n                  if (uniform_block == undefined){\r\n                    uniform_block = {\r\n                      index:blockIndices[i], \r\n                      name:gl.getActiveUniformBlockName(ptr, blockIndices[i]), \r\n                      size:gl.getActiveUniformBlockParameter(ptr, blockIndices[i], gl.UNIFORM_BLOCK_DATA_SIZE),\r\n                      uniforms:[]};\r\n                    resinfo.uniforms_blocks.push(uniform_block);\r\n                  }\r\n                  uniform_block.uniforms.push(\r\n                    {name:info.name, type:this.glEnumToString(gl, info.type), size:info.size, offset:offsets[i]}\r\n                  )\r\n                }\r\n                else{\r\n                  resinfo.uniforms.push({name:info.name, type:this.glEnumToString(gl, info.type), size:info.size, location:gl.getUniformLocation(ptr, info.name)});\r\n                }\r\n              }\r\n            }\r\n            resinfo.attributes = [];\r\n            const numAttribute = gl.getProgramParameter(ptr, gl.ACTIVE_ATTRIBUTES);\r\n            for (let i = 0; i < numAttribute; ++i) {\r\n              const info = gl.getActiveAttrib(ptr, i);\r\n              if (info)\r\n                resinfo.attributes.push({name:info.name, type:this.glEnumToString(gl, info.type), size:info.size, location:gl.getAttribLocation(ptr, info.name)});\r\n            }\r\n          }\r\n          res.set('_info', resinfo);\r\n          res.save_changes();\r\n        }\r\n        break;\r\n      case 'useProgram':{\r\n          if(command.program >= 0){\r\n            const res = this.get_resource(command.program);\r\n            const ptr = res.get('_gl_ptr');\r\n            gl.useProgram(ptr);\r\n            this.bound_program = res;\r\n          } else {\r\n            gl.useProgram(null);\r\n            this.bound_program = null;\r\n          }\r\n        }\r\n        break;\r\n      case 'uniform':\r\n      case 'uniformMatrix':\r\n        {\r\n          if(this.bound_program != null){\r\n            let resinfo = this.bound_program.get('_info');\r\n            const uniform = resinfo.uniforms.find((element:any)=>{return element.name == command.name});\r\n            if (uniform != undefined){\r\n              const location = uniform.location;\r\n\r\n              if (command.cmd == 'uniform'){\r\n                let shape = command.buffer_metadata.shape[command.buffer_metadata.shape.length-1];\r\n                if (command.buffer_metadata.dtype == 'int32'){\r\n                  let bufarray:Int32Array = converted_buffers[command.buffer_metadata.index] as Int32Array;\r\n                  if (shape == 1) gl.uniform1iv(location, bufarray);\r\n                  else if (shape == 2) gl.uniform2iv(location, bufarray);\r\n                  else if (shape == 3) gl.uniform3iv(location, bufarray);\r\n                  else if (shape == 4) gl.uniform4iv(location, bufarray);\r\n                }\r\n                else if (command.buffer_metadata.dtype == 'uint32'){\r\n                  let bufarray:Uint32Array = converted_buffers[command.buffer_metadata.index] as Uint32Array;\r\n                  if (shape == 1) gl.uniform1uiv(location, bufarray);\r\n                  else if (shape == 2) gl.uniform2uiv(location, bufarray);\r\n                  else if (shape == 3) gl.uniform3uiv(location, bufarray);\r\n                  else if (shape == 4) gl.uniform4uiv(location, bufarray);\r\n                }\r\n                else if (command.buffer_metadata.dtype == 'float32'){\r\n                  let bufarray:Float32Array = converted_buffers[command.buffer_metadata.index] as Float32Array;\r\n                  if (shape == 1) gl.uniform1fv(location, bufarray);\r\n                  else if (shape == 2) gl.uniform2fv(location, bufarray);\r\n                  else if (shape == 3) gl.uniform3fv(location, bufarray);\r\n                  else if (shape == 4) gl.uniform4fv(location, bufarray);\r\n                }\r\n              }\r\n\r\n              else {\r\n                let a = command.buffer_metadata.shape[command.buffer_metadata.shape.length-2];\r\n                let b = command.buffer_metadata.shape[command.buffer_metadata.shape.length-1];\r\n                let bufarray:Float32Array = converted_buffers[command.buffer_metadata.index] as Float32Array;\r\n                if (a==2)\r\n                {\r\n                  if (b==2) gl.uniformMatrix2fv(location, false, bufarray);\r\n                  else if (b==3) gl.uniformMatrix2x3fv(location, false, bufarray);\r\n                  else if (b==4)gl.uniformMatrix2x4fv(location, false, bufarray);\r\n                }\r\n                else if (a==3)\r\n                {\r\n                  if (b==2) gl.uniformMatrix3x2fv(location, false, bufarray);\r\n                  else if (b==3) gl.uniformMatrix3fv(location, false, bufarray);\r\n                  else if (b==4)gl.uniformMatrix3x4fv(location, false, bufarray);\r\n                }\r\n                else if (a==4)\r\n                {\r\n                  if (b==2) gl.uniformMatrix4x2fv(location, false, bufarray);\r\n                  else if (b==3) gl.uniformMatrix4x3fv(location, false, bufarray);\r\n                  else if (b==4)gl.uniformMatrix4fv(location, false, bufarray);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      break;\r\n      case 'uniformBlockBinding':{\r\n        let res = this.get_resource(command.program);\r\n        const ptr = res.get('_gl_ptr');\r\n        const uniformblock = res.get('_info').uniforms_blocks.find((element:any)=>{return element.name == command.uniform_block_name});\r\n        if (uniformblock != undefined){\r\n          gl.uniformBlockBinding(ptr, uniformblock.index, command.uniform_block_binding);\r\n        }\r\n      }\r\n      break;\r\n      // ------------------------------- BUFFERS --------------------------------------\r\n      case 'createBuffer':{\r\n          let res = this.get_resource(command.resource);\r\n          const ptr = gl.createBuffer();\r\n          res.set('_gl_ptr', ptr);\r\n          res.set('_info', {type:'Buffer'});\r\n          res.save_changes();\r\n        }\r\n        break;\r\n      case 'bindBuffer':{\r\n          const target:string = command.target;\r\n          if(command.buffer >= 0){\r\n            const res = this.get_resource(command.buffer);\r\n            const ptr = res.get('_gl_ptr');\r\n            gl.bindBuffer((gl as any)[target], ptr);\r\n            (this.bound_buffers as any)[target] = res;\r\n          } else {\r\n            gl.bindBuffer((gl as any)[target], null);\r\n            (this.bound_buffers as any)[target]  = null;\r\n          }\r\n        }\r\n        break;\r\n      case 'bindBufferBase':{\r\n          const target:string = command.target;\r\n          if(command.buffer >= 0){\r\n            const res = this.get_resource(command.buffer);\r\n            const ptr = res.get('_gl_ptr');\r\n            gl.bindBufferBase((gl as any)[target], command.index, ptr);\r\n          } else {\r\n            gl.bindBufferBase((gl as any)[target], command.index, null);\r\n          }\r\n        }\r\n        break;\r\n      case 'bufferData':{\r\n          const target:string = command.target;\r\n          const usage:string = command.usage;\r\n\r\n          if (command.hasOwnProperty('buffer_metadata')){\r\n            gl.bufferData((gl as any)[target], converted_buffers[command.buffer_metadata.index], (gl as any)[usage]);\r\n\r\n            let buf = (this.bound_buffers as any)[target];\r\n            if (command.update_info && buf != null){\r\n              const size = gl.getBufferParameter((gl as any)[target], gl.BUFFER_SIZE);\r\n              buf.set('_info', {type:\"Buffer\", size:size, target:target});\r\n              buf.save_changes();\r\n            }\r\n          }\r\n          else{\r\n            let buf = (this.bound_buffers as any)[target];\r\n            gl.bufferData((gl as any)[target], null, (gl as any)[usage]);\r\n            if (command.update_info && buf != null){\r\n              buf.set('_info', {type:\"Buffer\", size:'Undefined', target:target});\r\n              buf.save_changes();\r\n            }\r\n          }\r\n        }\r\n        break;\r\n      case 'createUniformBuffer':{\r\n          let res = this.get_resource(command.buffer);\r\n          const ptr = gl.createBuffer();\r\n\r\n          let info = {type:'Buffer'};\r\n          const prog = this.get_resource(command.program);\r\n          const uniformblock = prog.get('_info').uniforms_blocks.find((element:any)=>{return element.name == command.block_name});\r\n          if (uniformblock != undefined){\r\n            gl.bindBuffer(gl.UNIFORM_BUFFER, ptr);\r\n            gl.bufferData(gl.UNIFORM_BUFFER, uniformblock.size, (gl as any)[command.usage]);\r\n            gl.bindBuffer(gl.UNIFORM_BUFFER, null);\r\n            (this.bound_buffers as any)[\"UNIFORM_BUFFER\"] = null;\r\n            (info as any)[\"size\"] = uniformblock.size;\r\n            (info as any)[\"target\"] = \"UNIFORM_BUFFER\";\r\n            (info as any)[\"uniformblock\"] = uniformblock;\r\n          }\r\n          res.set('_gl_ptr', ptr);\r\n          res.set('_info', info);\r\n          res.save_changes();\r\n        }\r\n        break;\r\n      case 'bufferSubData':\r\n      case 'bufferSubDataStr':{\r\n          const target:string = command.target;\r\n          let offset = command.dst_byte_offset;\r\n          if (command.cmd == 'bufferSubDataStr'){\r\n            offset = 0;\r\n            let buf = (this.bound_buffers as any)[target];\r\n            if (buf != null){\r\n              const uniformblock = buf.get('_info').uniformblock;\r\n              const uniform = uniformblock.uniforms.find((element:any)=>{return element.name == command.dst_byte_offset});\r\n              if (uniform != undefined){\r\n                offset = uniform.offset;\r\n              }\r\n            }\r\n          }\r\n          if (command.hasOwnProperty('buffer_metadata')){\r\n            gl.bufferSubData((gl as any)[target], offset, converted_buffers[command.buffer_metadata.index], command.src_offset);\r\n\r\n          }\r\n          else{\r\n            gl.bufferSubData((gl as any)[target], offset, command.src_offset);\r\n          }\r\n        }\r\n        break;\r\n      // ------------------------------- VERTEX ARRAYS --------------------------------------\r\n      case 'createVertexArray':{\r\n          let res = this.get_resource(command.resource);\r\n          const ptr = gl.createVertexArray();\r\n          res.set('_gl_ptr', ptr);\r\n          res.set('_info', {type:'Vertex Array Object', bindings:[]});\r\n          res.save_changes();\r\n        }\r\n        break;\r\n      case 'bindVertexArray':{\r\n          if(command.vertex_array >= 0){\r\n            const res = this.get_resource(command.vertex_array);\r\n            const ptr = res.get('_gl_ptr');\r\n            gl.bindVertexArray(ptr);\r\n            this.bound_vao = res;\r\n          } else {\r\n            gl.bindVertexArray(null);\r\n            this.bound_vao = null;\r\n          }\r\n        }\r\n        break;\r\n      case 'vertexAttribPointer':\r\n      case 'vertexAttribIPointer':\r\n      case 'enableVertexAttribArray':\r\n      case 'disableVertexAttribArray':\r\n      case 'vertexAttrib[1234]fv':\r\n      case 'vertexAttribI4[u]iv':\r\n        {\r\n          let index = -1;\r\n          if (typeof command.index === 'number'){\r\n            index = command.index;\r\n          }\r\n          else{\r\n            if (this.bound_program != null){\r\n              const attr = this.bound_program.get('_info').attributes.find((element:any)=>{return element.name == command.index});\r\n              if (attr != undefined){\r\n                index = attr.location;\r\n              }\r\n            }else{\r\n              console.error(\"a program must be bound to find the attribute\");\r\n            }\r\n          }\r\n          let buf = (this.bound_buffers as any)['ARRAY_BUFFER'];\r\n          if (index >= 0){\r\n            if (command.cmd == \"vertexAttribIPointer\"){\r\n              gl.vertexAttribIPointer(index, command.size, (gl as any)[command.type], command.stride, command.offset);\r\n              if (this.bound_vao != null && buf != null){\r\n                let vao_info = this.bound_vao.get('_info');\r\n                const buffer_uid = buf.get('uid');\r\n                let binding_info = vao_info.bindings.find((element:any)=>{return element.buffer_uid == buffer_uid});\r\n                if (binding_info == undefined){\r\n                  binding_info = {buffer_uid : buffer_uid, attributes : []};\r\n                  vao_info.bindings.push(binding_info);\r\n                }\r\n                binding_info.attributes.push({pointer:\"vertexAttribIPointer\", index:index, size:command.size, type:command.type, stride:command.stride, offset:command.offset})\r\n                this.bound_vao.set('_info', vao_info);\r\n                this.bound_vao.save_changes();\r\n              }\r\n            }\r\n            else if (command.cmd == \"vertexAttribPointer\"){\r\n              gl.vertexAttribPointer(index, command.size, (gl as any)[command.type], command.normalized, command.stride, command.offset);\r\n              if (this.bound_vao != null && buf != null){\r\n                let vao_info = this.bound_vao.get('_info');\r\n                const buffer_uid = buf.get('uid');\r\n                let binding_info = vao_info.bindings.find((element:any)=>{return element.buffer_uid == buffer_uid});\r\n                if (binding_info == undefined){\r\n                  binding_info = {buffer_uid : buffer_uid, attributes : []};\r\n                  vao_info.bindings.push(binding_info);\r\n                }\r\n                binding_info.attributes.push({pointer:\"vertexAttribPointer\", index:index, size:command.size, type:command.type, normalized:command.normalized, stride:command.stride, offset:command.offset})\r\n                this.bound_vao.set('_info', vao_info);\r\n                this.bound_vao.save_changes();\r\n              }\r\n            }\r\n            else if (command.cmd == \"enableVertexAttribArray\"){\r\n              gl.enableVertexAttribArray(index);\r\n            }\r\n            else if (command.cmd == \"disableVertexAttribArray\"){\r\n              gl.disableVertexAttribArray(index);\r\n            }\r\n            else if (command.cmd == \"vertexAttrib[1234]fv\"){\r\n              if (command.buffer_metadata.shape[0] == 1){\r\n                gl.vertexAttrib1fv(index, converted_buffers[command.buffer_metadata.index]);\r\n              } else if (command.buffer_metadata.shape[0] == 2){\r\n                gl.vertexAttrib2fv(index, converted_buffers[command.buffer_metadata.index]);\r\n              } if (command.buffer_metadata.shape[0] == 3){\r\n                gl.vertexAttrib3fv(index, converted_buffers[command.buffer_metadata.index]);\r\n              }if (command.buffer_metadata.shape[0] == 4){\r\n                gl.vertexAttrib4fv(index, converted_buffers[command.buffer_metadata.index]);\r\n              }\r\n            }\r\n            else if (command.cmd == \"vertexAttribI4[u]iv\"){\r\n              if(command.buffer_metadata.dtype == \"uint32\"){\r\n                gl.vertexAttribI4uiv(index, converted_buffers[command.buffer_metadata.index]);\r\n              } else if(command.buffer_metadata.dtype == \"int32\"){\r\n                gl.vertexAttribI4iv(index, converted_buffers[command.buffer_metadata.index]);\r\n              }\r\n            }\r\n          }\r\n          else{\r\n            console.error(`attribute ${command.index} location not found`);\r\n          }\r\n        }\r\n        break;\r\n\r\n        // ------------------------------- RENDER --------------------------------------\r\n        case 'drawArrays':{\r\n          gl.drawArrays((gl as any)[command.mode], command.first, command.count);\r\n        }\r\n        break;\r\n        case 'drawArraysInstanced':{\r\n          gl.drawArraysInstanced((gl as any)[command.mode], command.first, command.count, command.instance_count);\r\n        }\r\n        break;\r\n        case 'drawElements':{\r\n          gl.drawElements((gl as any)[command.mode], command.count, (gl as any)[command.type], command.offset);\r\n        }\r\n        break;\r\n        case 'drawElementsInstanced':{\r\n          gl.drawElementsInstanced((gl as any)[command.mode], command.count, (gl as any)[command.type], command.offset, command.instance_count);\r\n        }\r\n        break;\r\n\r\n        // ------------------------------- FRAMEBUFFER --------------------------------------\r\n        case 'createFramebuffer':{\r\n          let res = this.get_resource(command.resource);\r\n          const ptr = gl.createFramebuffer();\r\n          res.set('_gl_ptr', ptr);\r\n          res.set('_info', {type:'Framebuffer'});\r\n          res.save_changes();\r\n        }\r\n        break;\r\n        case 'bindFramebuffer':{\r\n          if (command.framebuffer >= 0){\r\n            let res = this.get_resource(command.framebuffer);\r\n            gl.bindFramebuffer((gl as any)[command.target], res.get('_gl_ptr'));\r\n          }\r\n          else{\r\n            gl.bindFramebuffer((gl as any)[command.target], null);\r\n          }\r\n        }\r\n        break;\r\n        case 'framebufferTexture2D':{\r\n          let res = this.get_resource(command.texture);\r\n          gl.framebufferTexture2D((gl as any)[command.target], (gl as any)[command.attachement], (gl as any)[command.textarget], res.get('_gl_ptr'), command.level);\r\n        }\r\n        break;\r\n        case 'drawBuffers' :{\r\n          const buffers = command.buffers.map((element:any)=>{return (gl as any)[element]; });\r\n          gl.drawBuffers(buffers);\r\n        }\r\n        break;\r\n        \r\n    }\r\n  }\r\n\r\n  register_resource(resource:GLResource){\r\n    if(resource.get('uid') != this.resources.length){\r\n      console.error('uid not matching what we have internally');\r\n    }\r\n    this.resources.push(resource);\r\n  }\r\n\r\n  get_resource(index:number){\r\n    return this.resources[index];\r\n  }\r\n\r\n  canvas: HTMLCanvasElement;\r\n  ctx: WebGL2RenderingContext | null;\r\n  view_block: WebGLBuffer | null;\r\n\r\n  resources : GLResource[] = [];\r\n  bound_program: GLResource | null;\r\n  bound_buffers = {};\r\n  bound_vao: GLResource | null;\r\n  commands : any[] = [];\r\n  buffers : any[] = [];\r\n\r\n  projection_matrix:number[];\r\n  camera_matrix:number[];\r\n  view_matrix:number[];\r\n  view_proj_matrix:number[];\r\n}\r\n\r\nexport class GLViewer extends DOMWidgetView {\r\n\r\n  render() {\r\n    this.el.appendChild(this.model.canvas);\r\n\r\n    this.resizeCanvas();\r\n    this.model.on_some_change(['width', 'height'], this.resizeCanvas, this);\r\n\r\n    this.el.addEventListener('mousemove', {\r\n      handleEvent: this.onMouseMove.bind(this)\r\n    });\r\n    this.el.addEventListener('mousedown', {\r\n      handleEvent: this.onMouseDown.bind(this)\r\n    });\r\n    this.el.addEventListener('mouseup', {\r\n      handleEvent: this.onMouseUp.bind(this)\r\n    });\r\n    this.el.addEventListener('mouseout', {\r\n      handleEvent: this.onMouseOut.bind(this)\r\n    });\r\n    this.el.addEventListener('keydown', {\r\n      handleEvent: this.onKeyDown.bind(this)\r\n    });\r\n    this.el.addEventListener('keyup', {\r\n      handleEvent: this.onKeyUp.bind(this)\r\n    });\r\n    this.el.setAttribute('tabindex', '0');\r\n  }\r\n \r\n  private resizeCanvas() {\r\n    this.el.setAttribute('width', this.model.get('width'));\r\n    this.el.setAttribute('height', this.model.get('height'));\r\n    this.model.resizeCanvas();\r\n  }\r\n\r\n  private redraw(){\r\n    this.will_redraw = false;\r\n\r\n    // update movement if needed\r\n    if (this.move_direction[0] || this.move_direction[1] || this.move_direction[2] || this.move_direction[3])\r\n    {\r\n      let speed = this.model.get('move_speed');\r\n      let forward_axis = m4getColumnK(this.model.camera_matrix);\r\n      let side_axis = m4getColumnI(this.model.camera_matrix);\r\n      let camera_pos = this.model.get('camera_pos');\r\n      if (this.move_direction[0]){\r\n        camera_pos = vec3Add(camera_pos, vec3Scale(forward_axis, -speed));\r\n      }\r\n      if (this.move_direction[2]){\r\n        camera_pos = vec3Add(camera_pos, vec3Scale(forward_axis, speed));\r\n      }\r\n      if (this.move_direction[1]){\r\n        camera_pos = vec3Add(camera_pos, vec3Scale(side_axis, -speed));\r\n      }\r\n      if (this.move_direction[3]){\r\n        camera_pos = vec3Add(camera_pos, vec3Scale(side_axis, speed));\r\n      }\r\n      this.model.set('camera_pos', camera_pos);\r\n      this.touch();\r\n      // request a new frame if we are moving\r\n      this.requestRedraw();\r\n    }\r\n\r\n    // re draw\r\n    this.model.run_commands();\r\n  }\r\n\r\n  private requestRedraw(){\r\n    if (this.will_redraw == false){\r\n      this.will_redraw = true;\r\n      requestAnimationFrame(this.redraw.bind(this));\r\n    }\r\n  }\r\n\r\n  private onMouseMove(event: MouseEvent) {\r\n    //this.model.send({ event: 'mouse_move', ...this.getCoordinates(event) }, {});\r\n    if(this.is_mouse_down){\r\n      let speed = this.model.get('mouse_speed');\r\n      this.model.set('camera_yaw', this.model.get('camera_yaw')-(event.movementX)*0.2*speed);\r\n      this.model.set('camera_pitch', this.model.get('camera_pitch')-(event.movementY)*0.2*speed);\r\n      this.touch();\r\n      this.requestRedraw();\r\n    }\r\n  }\r\n\r\n  private onMouseDown(event: MouseEvent) {\r\n    this.is_mouse_down = true;\r\n    this.model.canvas.focus();\r\n  }\r\n\r\n  private onMouseUp(event: MouseEvent) {\r\n    this.is_mouse_down = false;\r\n  }\r\n\r\n  private onMouseOut(event: MouseEvent) {\r\n    this.is_mouse_down = false;\r\n    this.move_direction = [false, false, false, false];\r\n  }\r\n\r\n  private onKeyDown(event: KeyboardEvent) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    let keys = this.model.get('move_keys');\r\n\r\n    if(event.repeat == false){\r\n      if(event.key == keys[0]){\r\n        this.move_direction[0] = true;\r\n        this.requestRedraw();\r\n      }\r\n      else if(event.key == keys[1]){\r\n        this.move_direction[1] = true;\r\n        this.requestRedraw();\r\n      }\r\n      else if(event.key == keys[2]){\r\n        this.move_direction[2] = true;\r\n        this.requestRedraw();\r\n      }\r\n      else if(event.key == keys[3]){\r\n        this.move_direction[3] = true;\r\n        this.requestRedraw();\r\n      }\r\n    }\r\n  }\r\n\r\n  private onKeyUp(event: KeyboardEvent) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    let keys = this.model.get('move_keys');\r\n\r\n    if(event.key == keys[0]){\r\n      this.move_direction[0] = false;\r\n    }\r\n    else if(event.key == keys[1]){\r\n      this.move_direction[1] = false;\r\n    }\r\n    else if(event.key == keys[2]){\r\n      this.move_direction[2] = false;\r\n    }\r\n    else if(event.key == keys[3]){\r\n      this.move_direction[3] = false;\r\n    }\r\n  }\r\n\r\n  protected getCoordinates(event: MouseEvent | Touch) {\r\n    const rect = this.el.getBoundingClientRect();\r\n\r\n    const x = (this.model.get('width') * (event.clientX - rect.left)) / rect.width;\r\n    const y = (this.model.get('height') * (event.clientY - rect.top)) / rect.height;\r\n\r\n    return { x, y };\r\n  }\r\n\r\n  model : GLModel;\r\n  is_mouse_down : boolean = false;\r\n  move_direction : boolean[] = [false, false, false, false];\r\n  will_redraw = false;\r\n}\r\n","// Copyright (c) Jerome Eippers\r\n// Distributed under the terms of the Modified BSD License.\r\n\r\nexport * from './version';\r\nexport * from './widgets';\r\n","export function m4ProjectionMatrix(fov_y: number, aspect_ratio: number, near: number, far: number){\r\n    const ymax = near * Math.tan(fov_y * Math.PI / 360.0)\r\n    const xmax = ymax * aspect_ratio\r\n\r\n    return frustrum(-xmax, xmax, -ymax, ymax, near, far)\r\n}\r\n\r\nfunction frustrum(left: number, right: number, bottom: number, top: number, near: number, far: number) {\r\n    const A = (right + left) / (right - left)\r\n    const B = (top + bottom) / (top - bottom)\r\n    const C = -(far + near) / (far - near)\r\n    const D = -2. * far * near / (far - near)\r\n    const E = 2. * near / (right - left)\r\n    const F = 2. * near / (top - bottom)\r\n\r\n    return [\r\n        E, 0, A, 0,\r\n        0, F, B, 0,\r\n        0, 0, C, D,\r\n        0, 0, -1, 0\r\n    ]\r\n}\r\n\r\nexport function m4OrthographicProjectionMatrix(width: number, height: number, near: number, far: number) {\r\n    const A = 1. / width;\r\n    const B = 1. / height;\r\n    const C = -(far + near) / (far - near)\r\n    const D = -2. / (far - near)\r\n\r\n    return [\r\n        A, 0, 0, 0,\r\n        0, B, 0, 0,\r\n        0, 0, D, C,\r\n        0, 0, 0, 1\r\n    ]\r\n}\r\n\r\nexport function m4Transpose(m:number[]){\r\n    return [\r\n        m[0], m[4], m[8], m[12],\r\n        m[1], m[5], m[9], m[13],\r\n        m[2], m[6], m[10], m[14],\r\n        m[3], m[7], m[11], m[15],\r\n    ];\r\n}\r\n\r\nexport function m4getTranslation(m:number[]){\r\n    return [\r\n        m[3], m[7], m[11]\r\n    ];\r\n}\r\n\r\nexport function m4getColumnI(m:number[]){\r\n    return [\r\n        m[0], m[4], m[8]\r\n    ];\r\n}\r\n\r\nexport function m4getColumnJ(m:number[]){\r\n    return [\r\n        m[1], m[5], m[9]\r\n    ];\r\n}\r\n\r\nexport function m4getColumnK(m:number[]){\r\n    return [\r\n        m[2], m[6], m[10]\r\n    ];\r\n}\r\n\r\nexport function vec3Add(a:number[], b:number[]){\r\n    return[\r\n        a[0] + b[0],\r\n        a[1] + b[1],\r\n        a[2] + b[2]\r\n    ]\r\n}\r\n\r\nexport function vec3Scale(a:number[], scale:number){\r\n    return[\r\n        a[0] * scale,\r\n        a[1] * scale,\r\n        a[2] * scale\r\n    ]\r\n}\r\n\r\nexport function m4Translation(tx:number, ty:number, tz:number) {\r\n    return [\r\n        1, 0, 0, tx,\r\n        0, 1, 0, ty,\r\n        0, 0, 1, tz,\r\n        0, 0, 0, 1,\r\n    ];\r\n}\r\n\r\nexport function m4Xrotation(angleInRadians:number) {\r\n    var c = Math.cos(angleInRadians);\r\n    var s = Math.sin(angleInRadians);\r\n\r\n    return [\r\n        1, 0, 0, 0,\r\n        0, c, -s, 0,\r\n        0, s, c, 0,\r\n        0, 0, 0, 1,\r\n    ];\r\n}\r\n\r\nexport function m4Yrotation(angleInRadians:number) {\r\n    var c = Math.cos(angleInRadians);\r\n    var s = Math.sin(angleInRadians);\r\n\r\n    return [\r\n        c, 0, s, 0,\r\n        0, 1, 0, 0,\r\n        -s, 0, c, 0,\r\n        0, 0, 0, 1,\r\n    ];\r\n}\r\n\r\nexport function m4Zrotation(angleInRadians:number) {\r\n    var c = Math.cos(angleInRadians);\r\n    var s = Math.sin(angleInRadians);\r\n\r\n    return [\r\n        c, -s, 0, 0,\r\n        s, c, 0, 0,\r\n        0, 0, 1, 0,\r\n        0, 0, 0, 1,\r\n    ];\r\n}\r\n\r\nexport function m4Scale(sx:number, sy:number, sz:number) {\r\n    return [\r\n        sx, 0,  0,  0,\r\n        0, sy,  0,  0,\r\n        0,  0, sz,  0,\r\n        0,  0,  0,  1,\r\n    ];\r\n}\r\n\r\nexport function m4dot(b:number[], a:number[]) {\r\n    return [\r\n        b[0] * a[0] + b[1] * a[4] + b[2] * a[8] + b[3] * a[12],\r\n        b[0] * a[1] + b[1] * a[5] + b[2] * a[9] + b[3] * a[13],\r\n        b[0] * a[2] + b[1] * a[6] + b[2] * a[10] + b[3] * a[14],\r\n        b[0] * a[3] + b[1] * a[7] + b[2] * a[11] + b[3] * a[15],\r\n        b[4] * a[0] + b[5] * a[4] + b[6] * a[8] + b[7] * a[12],\r\n        b[4] * a[1] + b[5] * a[5] + b[6] * a[9] + b[7] * a[13],\r\n        b[4] * a[2] + b[5] * a[6] + b[6] * a[10] + b[7] * a[14],\r\n        b[4] * a[3] + b[5] * a[7] + b[6] * a[11] + b[7] * a[15],\r\n        b[8] * a[0] + b[9] * a[4] + b[10] * a[8] + b[11] * a[12],\r\n        b[8] * a[1] + b[9] * a[5] + b[10] * a[9] + b[11] * a[13],\r\n        b[8] * a[2] + b[9] * a[6] + b[10] * a[10] + b[11] * a[14],\r\n        b[8] * a[3] + b[9] * a[7] + b[10] * a[11] + b[11] * a[15],\r\n        b[12] * a[0] + b[13] * a[4] + b[14] * a[8] + b[15] * a[12],\r\n        b[12] * a[1] + b[13] * a[5] + b[14] * a[9] + b[15] * a[13],\r\n        b[12] * a[2] + b[13] * a[6] + b[14] * a[10] + b[15] * a[14],\r\n        b[12] * a[3] + b[13] * a[7] + b[14] * a[11] + b[15] * a[15],\r\n    ];\r\n}\r\n\r\nexport function m4inverse(m:number[]) {\r\n    var tmp_0  = m[10] * m[15];\r\n    var tmp_1  = m[14] * m[11];\r\n    var tmp_2  = m[6] * m[15];\r\n    var tmp_3  = m[14] * m[7];\r\n    var tmp_4  = m[6] * m[11];\r\n    var tmp_5  = m[10] * m[7];\r\n    var tmp_6  = m[2] * m[15];\r\n    var tmp_7  = m[14] * m[3];\r\n    var tmp_8  = m[2] * m[11];\r\n    var tmp_9  = m[10] * m[3];\r\n    var tmp_10 = m[2] * m[7];\r\n    var tmp_11 = m[6] * m[3];\r\n    var tmp_12 = m[8] * m[13];\r\n    var tmp_13 = m[12] * m[9];\r\n    var tmp_14 = m[4] * m[13];\r\n    var tmp_15 = m[12] * m[5];\r\n    var tmp_16 = m[4] * m[9];\r\n    var tmp_17 = m[8] * m[5];\r\n    var tmp_18 = m[0] * m[13];\r\n    var tmp_19 = m[12] * m[1];\r\n    var tmp_20 = m[0] * m[9];\r\n    var tmp_21 = m[8] * m[1];\r\n    var tmp_22 = m[0] * m[5];\r\n    var tmp_23 = m[4] * m[1];\r\n\r\n    var t0 = (tmp_0 * m[5] + tmp_3 * m[9] + tmp_4 * m[13]) -\r\n             (tmp_1 * m[5] + tmp_2 * m[9] + tmp_5 * m[13]);\r\n    var t1 = (tmp_1 * m[1] + tmp_6 * m[9] + tmp_9 * m[13]) -\r\n             (tmp_0 * m[1] + tmp_7 * m[9] + tmp_8 * m[13]);\r\n    var t2 = (tmp_2 * m[1] + tmp_7 * m[5] + tmp_10 * m[13]) -\r\n             (tmp_3 * m[1] + tmp_6 * m[5] + tmp_11 * m[13]);\r\n    var t3 = (tmp_5 * m[1] + tmp_8 * m[5] + tmp_11 * m[9]) -\r\n             (tmp_4 * m[1] + tmp_9 * m[5] + tmp_10 * m[9]);\r\n\r\n    var d = 1.0 / (m[0] * t0 + m[4] * t1 + m[8] * t2 + m[12] * t3);\r\n\r\n    return [\r\n      d * t0,\r\n      d * t1,\r\n      d * t2,\r\n      d * t3,\r\n      d * ((tmp_1 * m[4] + tmp_2 * m[8] + tmp_5 * m[12]) -\r\n           (tmp_0 * m[4] + tmp_3 * m[8] + tmp_4 * m[12])),\r\n      d * ((tmp_0 * m[0] + tmp_7 * m[8] + tmp_8 * m[12]) -\r\n           (tmp_1 * m[0] + tmp_6 * m[8] + tmp_9 * m[12])),\r\n      d * ((tmp_3 * m[0] + tmp_6 * m[4] + tmp_11 * m[12]) -\r\n           (tmp_2 * m[0] + tmp_7 * m[4] + tmp_10 * m[12])),\r\n      d * ((tmp_4 * m[0] + tmp_9 * m[4] + tmp_10 * m[8]) -\r\n           (tmp_5 * m[0] + tmp_8 * m[4] + tmp_11 * m[8])),\r\n      d * ((tmp_12 * m[7] + tmp_15 * m[11] + tmp_16 * m[15]) -\r\n           (tmp_13 * m[7] + tmp_14 * m[11] + tmp_17 * m[15])),\r\n      d * ((tmp_13 * m[3] + tmp_18 * m[11] + tmp_21 * m[15]) -\r\n           (tmp_12 * m[3] + tmp_19 * m[11] + tmp_20 * m[15])),\r\n      d * ((tmp_14 * m[3] + tmp_19 * m[7] + tmp_22 * m[15]) -\r\n           (tmp_15 * m[3] + tmp_18 * m[7] + tmp_23 * m[15])),\r\n      d * ((tmp_17 * m[3] + tmp_20 * m[7] + tmp_23 * m[11]) -\r\n           (tmp_16 * m[3] + tmp_21 * m[7] + tmp_22 * m[11])),\r\n      d * ((tmp_14 * m[10] + tmp_17 * m[14] + tmp_13 * m[6]) -\r\n           (tmp_16 * m[14] + tmp_12 * m[6] + tmp_15 * m[10])),\r\n      d * ((tmp_20 * m[14] + tmp_12 * m[2] + tmp_19 * m[10]) -\r\n           (tmp_18 * m[10] + tmp_21 * m[14] + tmp_13 * m[2])),\r\n      d * ((tmp_18 * m[6] + tmp_23 * m[14] + tmp_15 * m[2]) -\r\n           (tmp_22 * m[14] + tmp_14 * m[2] + tmp_19 * m[6])),\r\n      d * ((tmp_22 * m[10] + tmp_16 * m[2] + tmp_21 * m[6]) -\r\n           (tmp_20 * m[6] + tmp_23 * m[10] + tmp_17 * m[2])),\r\n    ];\r\n  }\r\n","// Copyright (c) Jerome Eippers\r\n// Distributed under the terms of the Modified BSD License.\r\n\r\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n// @ts-ignore\r\n// eslint-disable-next-line @typescript-eslint/no-var-requires\r\nconst data = require('../package.json');\r\n\r\n/**\r\n * The _model_module_version/_view_module_version this package implements.\r\n *\r\n * The html widget manager assumes that this is the same as the npm package\r\n * version number.\r\n */\r\nexport const MODULE_VERSION = data.version;\r\n\r\n/*\r\n * The current package name.\r\n */\r\nexport const MODULE_NAME = data.name;\r\n","export * from './glviewer';\r\nexport * from './glresource';\r\n\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__146__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.nc = undefined;","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(607);\n"],"names":["exports","___CSS_LOADER_API_IMPORT___","push","module","id","useSourceMap","list","toString","this","map","item","content","sourceMap","base64","data","cssMapping","btoa","sourceMapping","unescape","encodeURIComponent","JSON","stringify","concat","sourceURLs","sources","source","sourceRoot","join","cssWithMappingToString","i","modules","mediaQuery","dedupe","alreadyImportedModules","length","_i","api","__esModule","default","options","locals","memo","getTarget","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","stylesInDom","getIndexByIdentifier","identifier","result","modulesToDom","idCountMap","identifiers","base","count","index","obj","css","media","references","updater","addStyle","insertStyleElement","style","createElement","attributes","nonce","Object","keys","forEach","key","setAttribute","insert","Error","appendChild","textStore","replaceText","replacement","filter","Boolean","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","firstChild","singleton","singletonCounter","update","styleIndex","bind","parentNode","removeStyleElement","newObj","all","atob","lastIdentifiers","newList","prototype","call","newLastIdentifiers","_index","splice","dtype","buffer","Int8Array","Uint8Array","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","GLResource","DOMWidgetModel","defaults","super","_model_name","_model_module","MODULE_NAME","_model_module_version","MODULE_VERSION","_view_name","_view_module","_view_module_version","_context","_gl_ptr","_info","type","uid","initialize","get","register_resource","serializers","deserialize","unpack_models","GLResourceView","DOMWidgetView","render","root","el","jsonDisplay","classList","add","jsonKey","textContent","jsonValue","model","displayJson","json","parent","nestedJsonDisplay","GLModel","resources","bound_buffers","commands","buffers","shader_matrix_major","width","height","camera_pos","camera_yaw","camera_pitch","mouse_speed","move_speed","move_keys","canvas","ctx","getContext","preserveDrawingBuffer","console","error","gl","view_block","createBuffer","bindBuffer","UNIFORM_BUFFER","bufferData","DYNAMIC_DRAW","bindBufferBase","getExtension","resizeCanvas","on_some_change","run_commands","on","handle_custom_messages","camera_matrix","m4Translation","view_matrix","m4inverse","viewport","projection_matrix","m4ProjectionMatrix","command","clear","converted_buffers","element","hasOwnProperty","converted","buffer_to_array","buffer_metadata","only_once","execute_commands","buffer_id_offset","update_camera","pos","yaw","Math","PI","pitch","m4dot","m4Yrotation","m4Xrotation","view_proj_matrix","cm","m4Transpose","cm_f32","vm","vm_f32","pm","pm_f32","vpm","vpm_f32","bufferSubData","execute_command","glEnumToString","value","cmd","x","y","cap","blend","BLEND","depth_test","DEPTH_TEST","dither","DITHER","polygon_offset_fill","POLYGON_OFFSET_FILL","sample_alpha_to_coverage","SAMPLE_ALPHA_TO_COVERAGE","sample_coverage","SAMPLE_COVERAGE","scissor_test","SCISSOR_TEST","stencil_test","STENCIL_TEST","rasterizer_discard","RASTERIZER_DISCARD","cull_face","CULL_FACE","enable","disable","clearColor","r","g","b","a","bits","depth","DEPTH_BUFFER_BIT","color","COLOR_BUFFER_BIT","stencil","STENCIL_BUFFER_BIT","frontFace","mode","cullFace","depthFunc","func","depthMask","flag","depthRange","z_near","z_far","blendColor","blendEquation","blendEquationSeparate","mode_rgb","mode_alpha","blendFunc","s_factor","d_factor","blendFuncSeparate","src_rgb","dst_rgb","src_alpha","dst_alpha","res","get_resource","resource","ptr","createTexture","set","save_changes","texture","bindTexture","activeTexture","TEXTURE0","generateMipmap","texImage2D","level","internal_format","border","format","data_type","texStorage2D","levels","texImage3D","texStorage3D","texParameteri","pname","param","texParameterf","pixelStorei","createShader","shader","shaderSource","compileShader","resinfo","getShaderParameter","COMPILE_STATUS","message","info","getShaderInfoLog","createProgram","prog","program","attachShader","bindAttribLocation","name","linkProgram","validateProgram","getProgramParameter","LINK_STATUS","viewBlockIndex","getUniformBlockIndex","uniformBlockBinding","uniforms_blocks","uniforms","numUniforms","ACTIVE_UNIFORMS","indices","Array","blockIndices","getActiveUniforms","UNIFORM_BLOCK_INDEX","offsets","UNIFORM_OFFSET","getActiveUniform","uniform_block","find","undefined","getActiveUniformBlockName","size","getActiveUniformBlockParameter","UNIFORM_BLOCK_DATA_SIZE","offset","location","getUniformLocation","numAttribute","ACTIVE_ATTRIBUTES","getActiveAttrib","getAttribLocation","useProgram","bound_program","uniform","shape","bufarray","uniform1iv","uniform2iv","uniform3iv","uniform4iv","uniform1uiv","uniform2uiv","uniform3uiv","uniform4uiv","uniform1fv","uniform2fv","uniform3fv","uniform4fv","uniformMatrix2fv","uniformMatrix2x3fv","uniformMatrix2x4fv","uniformMatrix3x2fv","uniformMatrix3fv","uniformMatrix3x4fv","uniformMatrix4x2fv","uniformMatrix4x3fv","uniformMatrix4fv","uniformblock","uniform_block_name","uniform_block_binding","usage","buf","update_info","getBufferParameter","BUFFER_SIZE","block_name","dst_byte_offset","src_offset","createVertexArray","bindings","vertex_array","bindVertexArray","bound_vao","attr","vertexAttribIPointer","stride","vao_info","buffer_uid","binding_info","pointer","vertexAttribPointer","normalized","enableVertexAttribArray","disableVertexAttribArray","vertexAttrib1fv","vertexAttrib2fv","vertexAttrib3fv","vertexAttrib4fv","vertexAttribI4uiv","vertexAttribI4iv","drawArrays","first","drawArraysInstanced","instance_count","drawElements","drawElementsInstanced","createFramebuffer","framebuffer","bindFramebuffer","framebufferTexture2D","attachement","textarget","drawBuffers","GLViewer","is_mouse_down","move_direction","will_redraw","addEventListener","handleEvent","onMouseMove","onMouseDown","onMouseUp","onMouseOut","onKeyDown","onKeyUp","redraw","speed","forward_axis","m4getColumnK","side_axis","m4getColumnI","vec3Add","vec3Scale","touch","requestRedraw","requestAnimationFrame","event","focus","preventDefault","stopPropagation","repeat","getCoordinates","rect","getBoundingClientRect","clientX","left","clientY","top","fov_y","aspect_ratio","near","far","ymax","tan","xmax","right","bottom","frustrum","m","scale","tx","ty","tz","angleInRadians","c","cos","s","sin","sx","sy","sz","tmp_0","tmp_1","tmp_2","tmp_3","tmp_4","tmp_5","tmp_6","tmp_7","tmp_8","tmp_9","tmp_10","tmp_11","tmp_12","tmp_13","tmp_14","tmp_15","tmp_16","tmp_17","tmp_18","tmp_19","tmp_20","tmp_21","tmp_22","tmp_23","t0","t1","t2","t3","d","version","__WEBPACK_EXTERNAL_MODULE__146__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","nc"],"sourceRoot":""}